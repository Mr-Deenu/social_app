{% extends "base.html" %}
{% block content %}

<h4 class="mb-3">ðŸ’¬ Inbox</h4>

<div class="list-group">
  {% for r in rows %}
    <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
       href="{% url 'chat:chat_room' r.convo.id %}">
      <div>
        <b>{{ r.other.username }}</b><br>
        <small class="text-muted">
          {% if r.last_msg %}
            {{ r.last_msg.text|default:"(shared post)"|truncatechars:35 }}
          {% else %}
            No messages yet
          {% endif %}
        </small>
      </div>

      {% if r.unread > 0 %}
        <span class="badge bg-danger rounded-pill">{{ r.unread }}</span>
      {% endif %}
    </a>
  {% empty %}
    <div class="text-muted">No conversations</div>
  {% endfor %}
</div>

{% endblock %}
